# GraffitiMap

一个专业的字典管理和分析工具，专注于字典导入、正则表达式分析、词条分类和数据导出功能。

## 功能特性

### 核心功能
- **字典管理**: 创建、导入、删除字典，支持多字典管理
- **文件导入导出**: 支持TXT、JSON、CSV、Excel格式的文件导入导出
- **去重功能**: 提供多种去重策略（精确匹配、忽略大小写、相似度匹配等）
- **正则表达式分析**: 基于预设正则模式分析词条，自动分类
- **字典相似性分析**: 分析两个字典的相似度并输出数字结果

### 界面功能
- **现代化GUI**: 基于PyQt6的现代化用户界面
- **多标签页**: 支持多个功能模块的标签页切换
- **三栏布局**: 字典列表、正则分类树、词条显示的清晰布局
- **批量操作**: 支持批量导入、导出、分类管理等操作

### 分析功能
- **词条统计**: 提供详细的词条统计信息
- **模式匹配**: 支持27种预设正则表达式模式
- **分类导出**: 支持按正则匹配分类导出特定词条集合
- **未匹配词条**: 显示未被正则表达式匹配的词条，便于优化正则规则

## 安装要求

### 系统要求
- Python 3.8 或更高版本
- Windows 10/11 (推荐)
- Microsoft Visual C++ 2015–2022 Redistributable

### 依赖包
```bash
pip install -r requirements.txt
```

主要依赖：
- PyQt6 >= 6.5.0
- pandas >= 1.5.0
- chardet >= 5.0.0
- openpyxl >= 3.0.0

## 快速开始

### 1. 克隆项目
```bash
git clone https://github.com/TwoconsinElizabech/GraffitiMap.git
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 运行程序
```bash
python main.py
```

### 4. 运行测试
```bash
python test_integration.py
```

## 项目结构

```
ProjectM/
├── main.py                 # 主启动文件
├── requirements.txt        # 依赖包列表
├── test_integration.py     # 集成测试脚本
├── README.md              # 项目说明文档
├── core/                  # 核心功能模块
│   ├── __init__.py
│   ├── database.py        # 数据库管理
│   ├── dictionary_manager.py  # 字典管理
│   ├── file_handler.py    # 文件处理
│   ├── deduplicator.py    # 去重功能
│   ├── analyzer.py        # 分析功能
│   └── exporter.py        # 导出功能
├── gui/                   # 图形界面模块
│   ├── __init__.py
│   ├── main_window.py     # 主窗口
│   ├── dictionary_widget.py  # 字典管理界面
│   ├── analyzer_widget.py # 分析功能界面
│   ├── big_dictionary_widget.py # 大字典处理界面
│   ├── regex_widget.py    # 正则表达式界面
│   └── settings_dialog.py # 设置对话框
├── utils/                 # 工具模块
│   ├── __init__.py
│   └── regex_helper.py    # 正则表达式工具
├── config/                # 配置文件
│   ├── __init__.py
│   ├── settings.py        # 应用设置
│   └── regex_patterns.json # 正则表达式配置
├── data/                  # 数据目录
│   ├── dictionary.db      # SQLite数据库文件
│   └── backups/           # 备份目录
├── logs/                  # 日志目录
│   └── app.log           # 应用日志文件
└── plans/                 # 项目文档
    ├── dictionary_tool_architecture.md  # 架构设计文档
    └── implementation_details.md        # 实现细节文档
```

## 使用说明

### 字典管理
1. **创建字典**: 点击"新建字典"按钮，输入字典名称和描述
2. **导入字典**: 支持从TXT、JSON、CSV、Excel文件导入字典
3. **删除字典**: 选择字典后点击删除按钮
4. **导出字典**: 将整个字典导出为多种格式
5. **正则分析**: 一键分析字典，按正则模式自动分类词条

### 字典分类视图
1. **分类树**: 左侧显示基于正则表达式的词条分类
2. **词条显示**: 右侧显示选中分类的具体词条内容
3. **未匹配分类**: 显示所有未被正则表达式匹配的词条
4. **分类导出**: 支持导出选中分类的词条集合

### 正则分析功能
1. **一键分析**: 使用所有配置的正则表达式模式分析字典
2. **分类统计**: 显示每个正则模式匹配的词条数量
3. **未匹配词条**: 识别未匹配的词条以便优化正则表达式
4. **结果导出**: 将分析结果按分类导出

### 字典相似性分析
1. **选择字典**: 选择两个要比较的字典
2. **相似度计算**: 使用Jaccard相似度算法计算相似度
3. **结果显示**: 显示0-1之间的相似度数值
4. **应用场景**: 用于检测重复字典、评估字典质量等

### 大字典处理
1. **字典合并**: 支持多个字典文件的合并操作
2. **去重统计**: 合并时自动去重并提供统计信息
3. **批量处理**: 支持大文件的批量导入和处理
4. **性能优化**: 针对大字典优化的处理算法

## 正则表达式模式

工具内置了27种常用的正则表达式模式，包括：

- **网络安全类**: SQL注入、XSS脚本、命令注入等
- **网络地址类**: URL、IP地址、邮箱地址等
- **文件路径类**: Windows路径、Linux路径、WordPress路径等
- **编程相关**: API端点、数据库表名、函数名等
- **通用模式**: 数字、日期、电话号码等

## 配置说明

### 数据库配置
- 数据库类型: SQLite
- 数据库文件: `data/dictionary.db`
- 自动创建表结构

### 正则表达式配置
- 配置文件: `config/regex_patterns.json`
- 支持自定义添加新的正则模式
- 支持模式的启用/禁用

### 应用设置
- 配置文件: `config/settings.py`
- 包含应用名称、版本、主题色等设置
- 支持自定义修改

## 开发说明

### 架构设计
- **分层架构**: 界面层、业务逻辑层、数据访问层
- **模块化设计**: 各功能模块独立，便于维护和扩展
- **事件驱动**: 基于PyQt6的信号槽机制

### 扩展开发
1. **添加新功能**: 在对应模块中添加新的类和方法
2. **自定义界面**: 继承现有界面类，实现自定义界面
3. **新增正则模式**: 在配置文件中添加新的正则表达式模式

### 测试
- **集成测试**: 运行 `test_integration.py` 进行完整功能测试
- **单元测试**: 各模块包含独立的测试代码
- **手动测试**: 通过GUI界面进行功能验证

## 常见问题

### Q: 程序启动失败，提示缺少PyQt6
A: 请确保已安装PyQt6：`pip install PyQt6`

### Q: 数据库文件损坏怎么办？
A: 删除 `data/dictionary.db` 文件，程序会自动重新创建

### Q: 如何添加自定义正则表达式？
A: 编辑 `config/regex_patterns.json` 文件，按照现有格式添加新模式

### Q: 导入大文件时程序卡顿
A: 大文件导入会有进度提示，请耐心等待。建议使用大字典处理模块处理超大文件

### Q: 正则分析没有匹配到预期的词条
A: 检查正则表达式配置，可以查看"未匹配"分类中的词条来优化正则规则

### Q: 字典相似度分析结果如何理解？
A: 相似度值在0-1之间，越接近1表示两个字典越相似，0表示完全不同

## 技术特性

### 相似度算法
- **Jaccard相似度**: 使用集合交集与并集的比值计算相似度
- **应用场景**: 检测重复字典、评估字典质量、字典去重等
- **计算公式**: similarity = |A ∩ B| / |A ∪ B|

### 性能优化
- **多线程处理**: 正则分析使用后台线程，避免界面卡顿
- **内存优化**: 大字典按需加载，减少内存占用
- **批量处理**: 支持大文件的分块处理和批量操作

### 数据安全
- **自动备份**: 重要操作前自动创建数据备份
- **事务处理**: 数据库操作使用事务确保数据一致性
- **错误恢复**: 完善的错误处理和恢复机制

## 更新日志

### v1.0.0 (2026-01-18)
- 初始版本发布
- 实现字典管理核心功能
- 支持多种文件格式导入导出（TXT、JSON、CSV、Excel）
- 集成去重功能
- 提供27种预设正则表达式分析模式
- 新增字典相似性分析功能
- 新增大字典处理和合并功能
- 重新设计字典管理界面，专注于分类和导出
- 完整的GUI界面实现


## 作者

**TwoconsinElizabech** - GraffitiMap 字典管理工具

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue

---

**GraffitiMap** - 专业的字典管理和分析工具！
